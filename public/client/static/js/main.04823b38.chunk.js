(this["webpackJsonpafo-frontend"]=this["webpackJsonpafo-frontend"]||[]).push([[0],{280:function(e,t,a){},282:function(e,t,a){},283:function(e,t,a){},288:function(e,t,a){},289:function(e,t,a){},290:function(e,t,a){},291:function(e,t,a){},292:function(e,t,a){},315:function(e,t,a){},316:function(e,t,a){},317:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(13),o=a.n(c),l=(a(280),a(19)),i=a.n(l),u=a(28),s=a(11),m=a(15),d=(a(282),function(e){var t=e.children,a=e.green,n=e.onClick,c=e.primary,o=e.lg,l=e.link,i="button ";return i+=c?"primary-btn":"",i+=e.secondary?"secondary-btn":"",i+=a?"green-btn":"",i+=o?" lg-btn":" md-btn",r.a.createElement("a",{href:l,className:i,onClick:n},t)});d.default={link:""};var f=d,p=(a(283),a(50));function g(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()}var h={"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+g("token")};var b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(n.useState)(a),c=Object(s.a)(r,2),o=c[0],l=c[1],m=Object(n.useState)(e),d=Object(s.a)(m,2),f=d[0],g=d[1],b=Object(n.useState)({}),E=Object(s.a)(b,2),v=E[0],y=E[1];return Object(n.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=15;break}return e.prev=1,e.next=4,fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:h,body:JSON.stringify({query:f})});case 4:return a=e.sent,e.next=7,a.json();case 7:(n=e.sent)&&y(t?function(e){return Object(p.a)(Object(p.a)({},e),{loading:!1,data:n.data[t]})}:function(e){return Object(p.a)(Object(p.a)({},e),{loading:!1,data:n.data})}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),y((function(t){return Object(p.a)(Object(p.a)({},t),{loading:!1,data:null,error:e.t0.message})}));case 14:l(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))()}),[o]),[v.data,v.loading,v.error,l,g]},E=a(257),v=a.n(E);function y(e,t,a){var n=new Date,r=v()(n).format("YYYY-MM-DD");return"mutation { createGameTeam(record: {"+"teamId: ".concat(t?t.teamId:"",",")+"userId: ".concat(a?a.userId:"",", ")+'startDate: "'.concat(r,'", ')+"currentLeagueId: ".concat(e)+"}) {\n        recordId\n        record {\n            teamId\n        }\n        error {\n            __typename\n        }\n    }}"}var I=r.a.createContext("user"),j=function(){var e,t=Object(m.f)(),a=Object(n.useContext)(I),c=b((e=a?a.userId:null)?"query { gameTeams(filter: "+"{ userId: ".concat(e,"}) {")+"teamId\n                    userId\n                    startDate\n                    endDate\n                    currentLeagueId\n                }}":"","gameTeams"),o=Object(s.a)(c,3),l=o[0],i=o[1],u=o[2];return Object(n.useEffect)((function(){l&&!u&&t.push("/club/"+l.teamId)}),[l,u,t]),!i&&r.a.createElement("div",{className:"app-start"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"text-logo-left"},r.a.createElement("img",{src:"/public/client/LogoFFOText.svg",className:"text-logo",alt:"logo"})),r.a.createElement("div",{className:"text"},"Welcome to Fantasy Football Owner ",document.cookie.userName),r.a.createElement("div",{className:"text-logo-right"},r.a.createElement("img",{src:"/public/client/LogoFFOText.svg",className:"text-logo",alt:"logo"}))),r.a.createElement("section",{className:"app-start-action"},r.a.createElement("span",null,"This is a Fantasy Football game based on real events/data"),r.a.createElement("span",null,"Manager transitions, player crises, financial ruin?! This is fantasy football like no other."),r.a.createElement("span",null,"Legal notice: this is a non-comercial/amateur game. Players/users do not pay for any service."),r.a.createElement(f,{green:!0,lg:!0,onClick:function(){t.push("/new")}},"Start new game")))},O=a(340),w=(0,a(170).createMuiTheme)({palette:{primary:{main:"#69bb31"},secondary:{main:"#8f214d"}}}),k=a.p+"static/media/bgPattern.42364d20.svg",N=a(55),x=(a(288),a(124)),S=function e(){Object(x.a)(this,e)};S.getTeamsForLeague=function(e){return new Promise((function(t,a){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+g("token")},body:JSON.stringify({query:"query { teamsInCompetition(competitionId: ".concat(e,") {")+"teamId\n                    standing\n                    competitionId\n                }}"})}).then((function(e){return e.json()})).then((function(e){console.log(e.data),t(e.data.teamsInCompetition)})).catch((function(e){a(e)}))}))},S.getTeamFromTeamId=function(e){return new Promise((function(e,t){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+g("token")},body:JSON.stringify({query:T})}).then((function(e){return e.json()})).then((function(t){var a=t.data.getTeam;e(function(e){return{name:e.name,_id:e._id,logo:e.logo,ground:e.ground.name,capacity:e.ground.capacity,city:e.ground.city}}(a))})).catch((function(e){t(null,e)}))}))};var T=function(e){return"query { getTeam(filter: { teamId: ".concat(e," }) {")+"name \n                    logo\n                    teamId\n                    _id\n                    ground {\n                        name\n                        capacity\n                        city\n                    }\n                }}"};var C=r.a.createContext("team"),F=(a(289),function(e){var t=e.children;return r.a.createElement("div",{className:"loading"},r.a.createElement("div",{className:"loading-text-container"},t||r.a.createElement("div",null,"loading...")),r.a.createElement("div",{className:"app-logo-container"},r.a.createElement("img",{src:"/public/client/MainLogo.svg",className:"app-logo-loading",alt:"ball-logo"})))});a(290);function q(){var e=Object(n.useContext)(C);return r.a.createElement("header",null,r.a.createElement(N.b,{to:"/club/".concat(e.teamId)},r.a.createElement("img",{src:e.logo,className:"team-logo",alt:"".concat(e.name," logo")})),r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(N.b,{to:"/club/".concat(e.teamId,"/clubhouse")},r.a.createElement("div",{className:"flex"},"Clubhouse"))),r.a.createElement("li",null,r.a.createElement(N.b,{to:"/club/".concat(e.teamId,"/ground")},"Stadium")),r.a.createElement("li",null,r.a.createElement(N.b,{to:"/club/".concat(e.teamId,"/squad")},"Squad")))))}function A(){var e=Object(n.useContext)(C);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"rfhsdfh",e.name))}var B=function(e){var t=e.capacity,a=e.city,n=e.name;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"text-center"},n,", ",a),r.a.createElement("div",{className:"text-center"},"Capacity: ",t.toLocaleString("en-GB")))};function L(){var e=Object(n.useContext)(C);return e?r.a.createElement(r.a.Fragment,null,"hellllloooo",r.a.createElement(B,{capacity:e.ground.capacity,city:e.ground.city,name:e.ground.ground})):r.a.createElement(F,null)}var P=a(178),D=a(354),M=a(355),U=a(356),G=a(357),R=a(358),J=a(359),Y=a(363),z=a(243);function _(e){var t=e.classes,a=e.headCells,n=(e.onSelectAllClick,e.order),c=e.orderBy,o=(e.numSelected,e.rowCount,e.onRequestSort);t=W();return r.a.createElement(R.a,null,r.a.createElement(J.a,null,a.map((function(e){var a,l=e.id||e.name;return r.a.createElement(U.a,{key:l,align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",sortDirection:c===l&&n},r.a.createElement(Y.a,{active:c===l,direction:c===l?n:"asc",onClick:(a=l,function(e){o(e,a)})},e.label||e.name,c===l?r.a.createElement("span",{className:t.visuallyHidden},"desc"===n?"sorted descending":"sorted ascending"):null))}))))}var W=Object(z.a)((function(e){return{root:{width:"100%"},paper:{width:"100%",marginBottom:e.spacing(2)},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function H(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}var $={Attacker:1,Midfielder:2,Defender:3,Goalkeeper:4};function K(e,t,a){return $[t[a]]<$[e[a]]?-1:$[t[a]]>$[e[a]]?1:0}var Q=function(e){var t=e.className,a=e.columns,n=e.rows,c=e.rowMeta,o=e.defaultOrderDescBy,l=e.onRowClick,i=r.a.useState("asc"),u=Object(s.a)(i,2),m=u[0],d=u[1],f=r.a.useState(o),p=Object(s.a)(f,2),g=p[0],h=p[1];return n?r.a.createElement(G.a,{className:t,component:P.a},r.a.createElement(D.a,{"aria-label":"simple table"},r.a.createElement(_,{headCells:a,onRequestSort:function(e,t){d(g===t&&"asc"===m?"desc":"asc"),h(t)},orderBy:g,order:m}),r.a.createElement(M.a,null,function(e,t){var a=e.map((function(e,t){return[e,t]}));return a.sort((function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]})),a.map((function(e){return e[0]}))}(n,function(e,t){if(console.log("Getting Comparator",e,t),"positiontype"===t.toLowerCase())return"desc"===e?function(e,a){return K(e,a,t)}:function(e,a){return-K(e,a,t)};return"desc"===e?function(e,a){return H(e,a,t)}:function(e,a){return-H(e,a,t)}}(m,g)).map((function(e,t){return r.a.createElement(J.a,{key:t,onClick:function(){return l(e)}},c.map((function(t){var a=t.name;return r.a.createElement(U.a,{key:a,className:"afo-table-cell",component:"th",scope:"row",align:a.align?a.align:"left",sortDirection:g===a&&m},t.processor?t.processor(e[a]):e[a])})))}))))):null};function V(){var e,t=Object(n.useContext)(C),a=b((e=t.teamId,"query { playersInTeam(teamId: ".concat(e,") {")+"playerId\n        name\n        firstName\n        lastName\n        number\n        positionType\n        dob\n        height\n        weight}}"),"playersInTeam"),c=Object(s.a)(a,2),o=c[0],l=c[1],i=Object(m.f)(),u=[{name:"firstName"},{name:"lastName"},{name:"positionType"},{name:"dob",processor:X}];return t&&!l&&o?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,t.name," squad list"),r.a.createElement(Q,{className:"squad-table",defaultOrderDescBy:"positionType",columns:[{id:"firstName",name:"first"},{id:"lastName",name:"last"},{id:"positionType",name:"position"},{id:"dob",name:"age"}],onRowClick:function(e){console.log(e),i.push("squad/".concat(e.playerId))},rows:o,rowMeta:u})):r.a.createElement(F,null)}function X(e){var t=new Date,a=new Date(e),n=t.getFullYear()-a.getFullYear(),r=t.getMonth()-a.getMonth();return(r<0||0===r&&t.getDate()<a.getDate())&&n--,n}a(291);function Z(){var e=Object(m.h)("playerId").playerId;return r.a.createElement("div",null,e)}function ee(){var e=Object(m.h)("teamId"),t=Object(m.g)(),a=Object(n.useState)(null),c=Object(s.a)(a,2),o=c[0],l=c[1],i=Object(n.useContext)(I),u=b("","getTeam",!1),d=Object(s.a)(u,5),f=d[0],p=d[1],g=d[2],h=d[3],E=d[4];return Object(n.useEffect)((function(){e.teamId&&!isNaN(e.teamId)&&l(e.teamId)}),[e.teamId]),Object(n.useEffect)((function(){o&&(E(T(o)),h(!0))}),[h,E,o]),g?r.a.createElement("div",{className:"error"},"teamInfoError"):p?r.a.createElement(F,null):f?r.a.createElement(r.a.Fragment,null,r.a.createElement(C.Provider,{value:f},r.a.createElement(q,null),3===t.pathname.split("/").length&&r.a.createElement("div",{className:"welcome"},"Hi ",i.name,", the owner of ",f.name," FC."),r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/club/".concat(o,"/clubhouse")},r.a.createElement(A,null)),r.a.createElement(m.a,{exact:!0,path:"/club/".concat(o,"/ground")},r.a.createElement(L,null)),r.a.createElement(m.a,{exact:!0,path:"/club/".concat(o,"/squad")},r.a.createElement(V,null)),r.a.createElement(m.a,{exact:!0,path:"/club/".concat(o,"/squad/:playerId")},r.a.createElement(Z,null))))):null}var te=function e(){Object(x.a)(this,e)};te.getUsersFromTwitterId=function(e){return new Promise((function(t,a){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+g("token")},body:JSON.stringify({query:"query getUsers {\n                    users(filter: { twitterId: ".concat(e," }) {\n                      screenName\n                      name\n                      location\n                      authLevel\n                      userId\n                    }\n                  }")})}).then((function(e){return e.json()})).then((function(e){t(e.data.users)})).catch((function(e){a(e)}))}))},te.getUserInfo=function(){return new Promise((function(e,t){fetch("https://afcmbackend.herokuapp.com/graphql".replace("graphql","api/user"),{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+g("token")}}).then((function(e){return e.json()})).then((function(t){console.info&&console.info(t.user),e(t.user)})).catch((function(e){t(e)}))}))},te.createUser=function(e){var t=e.name,a=e.screenName,n=e.ffoUserId,r=e.location,c=e.userId;return new Promise((function(e,o){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+g("token")},body:JSON.stringify({query:"mutation addUser { \n                    createUser(record:{ userId: ".concat(n,", twitterId: ").concat(c,', screenName: "').concat(a,'", name: "').concat(t,'", location: "').concat(r,'", authLevel: PLAYER}) {\n                    recordId,\n                    record {\n                      name\n                      userId\n                      screenName\n                      location\n                      authLevel\n                    },\n                    error {\n                      message\n                    }\n                  }\n                }')})}).then((function(e){return e.json()})).then((function(t){console.log(t.data.createUser),e(t.data.createUser)})).catch((function(e){o(e)}))}))};a(360),a(245),a(351),a(244);var ae=a(341),ne=a(343),re=a(342),ce=a(263),oe=a.n(ce),le=a(108);var ie=f,ue=a(362),se=a(353),me=a(352),de=a(344),fe=a(262),pe=a.n(fe);a(292);function ge(e){return he.apply(this,arguments)}function he(){return(he=Object(u.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:h,body:JSON.stringify({query:"query { coaches(filter: { currentTeamId: ".concat(t," }) {")+"firstName\n                    lastName\n                    knownAs\n                    career {\n                        teamId,\n                        start,\n                        end\n                    }\n                }}"})});case 3:return a=e.sent,e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n.data.coaches[0]);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}var be=a(125),Ee=function(e){var t=e.broadcastingRevenue,a=[],n=function(e,t){if(e){var n=parseFloat(e);return a.push({angle:n,label:"\xa3".concat(n.toFixed(1),"m"),subLabel:"".concat(t)}),n}return 0},c=(n(t.equalShare,"Equal Share")+n(t.basicAward,"Basic Award")+n(t.solidarity,"Solidarity")+n((t.minimumFeaturedGames+1)*t.facilityFeePerGame,"Featured Game Facility Fees")+n(t.overseasPaymentMin,"Overseas")+n(t.centralCommercial,"Central Commercial")).toFixed(1);return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,"Minimum Estimated Broadcasting Revenue: \xa3",c,"m"),a.length>0||"0.0"===a[0].value?r.a.createElement(be.a,{colorType:"linear",colorDomain:[0,2],data:a,width:300,height:250,showLabels:!0,labelsAboveChildren:!0,className:"broadcasting-radial"}):r.a.createElement("div",null,"No information found for broadcasting"))};function ve(e){return ye.apply(this,arguments)}function ye(){return(ye=Object(u.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+g("token")},body:JSON.stringify({query:"query { broadcastRevenue(filter: { competitionId: ".concat(t," }) {")+"equalShare\n                    basicAward\n                    solidarity\n                    meritStart\n                    centralCommercial\n                    overseasPaymentMin\n                    minimumFeaturedGames\n                    facilityFeePerGame\n                }}"})});case 3:return a=e.sent,e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n.data.broadcastRevenue[0]);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function Ie(e,t){return"query { attendances(filter: "+"{ competitionId: ".concat(e,", teamId: ").concat(t," }) {")+"attendance\n                    seasonTickets\n                }}"}var je=function(e){var t=e.capacity,a=e.season,c=e.teamId,o=b(Ie(a.leagueId,c),"attendances"),l=Object(s.a)(o,5),i=l[0],u=l[1],m=l[2],d=l[3],f=l[4];console.log(i,u,m),Object(n.useEffect)((function(){f(Ie(a.leagueId,c)),d(!0)}),[a.leagueId,d,f,c]);var p=i&&i.length?i[0]:null,g=p?p.seasonTickets:0,h=p?p.attendance-g:0,E=p?t-p.attendance:0;return u?r.a.createElement(F,null):p&&!m?r.a.createElement("div",null,r.a.createElement(me.a,{item:!0,xs:8},r.a.createElement("div",null,"Average attendance: ",p.attendance.toLocaleString("en-GB")),r.a.createElement("div",null,"For ",a.name," ",new Date(a.start).getFullYear(),"/",new Date(a.end).getFullYear()),r.a.createElement(be.a,{colorType:"linear",colorDomain:[0,3],data:[{angle:h,label:"Matchday tickets: ".concat(h.toLocaleString("en-GB"))},{angle:g,label:"Season tickets: ".concat(g.toLocaleString("en-GB"))},{angle:E,label:"Unsold: ".concat(E.toLocaleString("en-GB"))}],width:300,height:250,showLabels:!0,labelsAboveChildren:!0,className:"matchday-radial"}))):r.a.createElement("div",null,r.a.createElement("span",null,"No data for ",we(a)))},Oe=r.a.createContext("competition");function we(e){return"".concat(e.competitionName,": ").concat(new Date(e.start).getFullYear(),"/").concat(new Date(e.end).getFullYear())}var ke=function(e){var t,a=e.broadcastingRevenue,c=e.onBack,o=e.onTeamSelect,l=e.teamInfo,m=Object(n.useContext)(Oe),d=Object(n.useState)(null),f=Object(s.a)(d,2),p=f[0],g=f[1],h=Object(n.useState)(null),E=Object(s.a)(h,2),v=E[0],y=E[1],I=b((t=l.teamId,"query { "+"leagueCompetitionsForTeam(teamId:".concat(t,") { ")+"teamId\n            competitionId\n            leagueId\n            year\n            start\n            end\n            competitionName\n    }}"),"leagueCompetitionsForTeam"),j=Object(s.a)(I,2),O=j[0],w=j[1];Object(n.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge(l.teamId);case 2:t=e.sent,g(t);case 4:case"end":return e.stop()}}),e)})))()}),[l.teamId]),Object(n.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!w&&O&&O.length&&(t=O.find((function(e){return e.leagueId===m.leagueId})),y(t||O[0]));case 1:case"end":return e.stop()}}),e)})))()}),[m.leagueId,O,w]);var k=!w&&v&&v.leagueId?r.a.createElement(ue.a,{value:v.leagueId,onChange:function(e){return y(O.find((function(t){return t.leagueId===e.target.value})))}},O.map((function(e){return r.a.createElement(se.a,{key:e.leagueId,value:e.leagueId},we(e))}))):null;return r.a.createElement(r.a.Fragment,null,p?r.a.createElement(me.a,{container:!0},r.a.createElement(me.a,{container:!0,justify:"space-around"},r.a.createElement(me.a,{item:!0},r.a.createElement(de.a,{variant:"contained",color:"secondary",onClick:function(){return c()},startIcon:r.a.createElement(pe.a,null)},"Back")),r.a.createElement(me.a,{item:!0},r.a.createElement(me.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},r.a.createElement("grid",{item:!0},r.a.createElement("h3",{className:"text-center"},l.name," Financial Analysis")),r.a.createElement("grid",{item:!0},k)),r.a.createElement(me.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},r.a.createElement("img",{src:l.logo,className:"team-logo",alt:"".concat(l.name," logo")})),r.a.createElement(B,{capacity:l.capacity,city:l.city,name:l.ground}),void 0!==p&&r.a.createElement("div",{className:"text-center"},"Current Manager: ",p.knownAs||p.firstName+" "+p.lastName)),r.a.createElement(me.a,{item:!0},r.a.createElement(Ee,{broadcastingRevenue:a})),r.a.createElement(me.a,{item:!0},v?r.a.createElement(je,{capacity:l.capacity,teamId:l.teamId,season:v}):r.a.createElement(F,null,r.a.createElement("div",null,"Loading Matchday Information")))),r.a.createElement(me.a,{container:!0,direction:"row",justify:"space-around",alignItems:"right"},r.a.createElement(me.a,{item:!0}),r.a.createElement(me.a,{item:!0},r.a.createElement(ie,{lg:!0,green:!0,onClick:function(){return o()}},"Select this team")))):r.a.createElement(F,null,r.a.createElement("div",null,"Finding team information")))},Ne=(a(315),a(345)),xe=a(346),Se=a(347),Te=function(e){e.competitionId;var t=e.onAnalyseTeam,a=e.teamInfo,n=a.name;return r.a.createElement(Ne.a,{className:"team-card"},r.a.createElement(Se.a,null,r.a.createElement("div",{className:"team-content"},r.a.createElement("img",{src:a.logo,alt:"".concat(n," logo")}))),r.a.createElement(xe.a,null,r.a.createElement(ie,{onClick:function(){return t(a)},green:!0},"Analyse ",n)))},Ce=function(e){var t=e.onTeamSelect,a=Object(n.useContext)(Oe),c=Object(n.useContext)(I),o=a.leagueId,l=function(e,t){var a=Object(n.useState)((function(){try{var a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(P){return console.log(P),t}})),r=Object(s.a)(a,2),c=r[0],o=r[1];return[c,function(t){try{var a=t instanceof Function?t(c):t;o(a),window.localStorage.setItem(e,JSON.stringify(a))}catch(P){console.log(P)}}]}("teamsByCompetitionId",[]),m=Object(s.a)(l,2),d=m[0],f=m[1],g=Object(n.useState)([]),h=Object(s.a)(g,2),E=h[0],v=h[1],j=Object(n.useState)(null),O=Object(s.a)(j,2),w=O[0],k=O[1],N=Object(n.useState)(null),x=Object(s.a)(N,2),T=x[0],C=x[1],q=b(y(a.leagueId,w,c),"createGameTeam",!1),A=Object(s.a)(q,5),B=A[0],L=A[1],P=A[2],D=A[3],M=A[4];return Object(n.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=d[o])){e.next=5;break}v(t),e.next=9;break;case 5:return e.next=7,S.getTeamsForLeague(o);case 7:a=e.sent,Promise.all(a.map(function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getTeamFromTeamId(t.teamId);case 2:return(a=e.sent).teamId=t.teamId,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){v(e),f(Object(p.a)(Object(p.a)({},d),{},Object(le.a)({},o,e)))}));case 9:case"end":return e.stop()}}),e)})))()}),[]),Object(n.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=5;break}return e.next=3,ve(o);case 3:t=e.sent,C(t);case 5:case"end":return e.stop()}}),e)})))()}),[w]),Object(n.useEffect)((function(){B&&!P&&t(B.record.teamId)}),[B]),E.length>0?w&&T?r.a.createElement(r.a.Fragment,null,r.a.createElement(ke,{onBack:function(){return k(null)},broadcastingRevenue:T,teamInfo:w,onTeamSelect:function(){M(y(a.leagueId,w,c)),D(!0)}}),L&&r.a.createElement(F,null,"Please wait..."),P&&r.a.createElement("div",null,"Error selecting team: ",P)):r.a.createElement("div",{className:"team-cards"},E.map((function(e){return r.a.createElement(Te,{key:e.teamId,onAnalyseTeam:function(e){return k(e)},teamInfo:e})}))):r.a.createElement(F,null)},Fe=(a(316),function(e){var t=e.competitions,a=e.onTeamSelect,c=Object(n.useState)("men"),o=Object(s.a)(c,2),l=o[0],i=(o[1],Object(n.useState)(null)),u=Object(s.a)(i,2),m=u[0],d=u[1];return t.length&&r.a.createElement("section",{className:"leagues"},r.a.createElement("div",{className:"pad-all-sm marg-bottom-sm flex",style:{color:"#fff",fontSize:"1.2rem"}},r.a.createElement("span",{className:"text-center",style:{width:"90%"}},"Take control! Select a team to analyse for financial viability."),r.a.createElement("span",{className:"align-right"},"Budget: 7m")),"men"===l&&t.filter((function(e){return!e.name.includes("WSL")&&(null===m||m===e.leagueId)})).sort((function(e,t){return e.tier>t.tier?1:-1})).map((function(e){return r.a.createElement(ae.a,{key:e.leagueId,onChange:function(t,a){d(a?e.leagueId:null)},className:"team-select-acc",TransitionProps:{unmountOnExit:!0}},r.a.createElement(ne.a,{expandIcon:r.a.createElement(oe.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},e.name),r.a.createElement(re.a,null,r.a.createElement(Oe.Provider,{value:e},r.a.createElement(Ce,{onTeamSelect:a}))))})))}),qe=function(){var e="query { competitions(filter: { AND: ["+'{ isCurrent: true }, { country: "'.concat("England",'" },')+"{ type: LEAGUE }]}){ name leagueId isCurrent tier logo country start}}",t=b(e,"competitions"),a=Object(s.a)(t,3),n=a[0],c=a[1],o=a[2],l=Object(m.f)();return!n||c||o?c?o?r.a.createElement("div",null,"Eek, something went wrong"):r.a.createElement(F,null,o):null:r.a.createElement(Fe,{competitions:n,onTeamSelect:function(e){l.push("/club/"+e)}})};var Ae=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),l=Object(s.a)(o,2),d=l[0],f=l[1],p=b("query getLatestUser {users(limit: 1, sort: USERID_DESC ) {userId}}","users",!1),g=Object(s.a)(p,4),h=g[0],E=g[1],v=g[2],y=g[3];return Object(n.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.getUserInfo();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,te.getUsersFromTwitterId(parseInt(t.userId));case 7:0===(a=e.sent).length?(f(t),y(!0)):c(a[0]);case 9:case"end":return e.stop()}}),e)})))()}),[y]),Object(n.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E||!h||!h[0].userId){e.next=9;break}return(t=d).ffoUserId=h[0].userId+1,e.next=5,te.createUser(t);case 5:(a=e.sent).error&&a.error.message?console.error("unable to create user: ",a.error.message):c(a.record),e.next=10;break;case 9:v&&console.error("unable to create user without latest user",v);case 10:case"end":return e.stop()}}),e)})))()}),[h,E,v,d]),a?r.a.createElement(I.Provider,{value:a},r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"background"},r.a.createElement("img",{alt:"background pattern",src:k})),r.a.createElement(O.a,{theme:w},r.a.createElement(N.a,{basename:"/ffo"},r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/"},r.a.createElement(j,null)),r.a.createElement(m.a,{exact:!0,path:"/new"},r.a.createElement(qe,null)),r.a.createElement(m.a,{path:"/club/:teamId"},r.a.createElement(ee,null)),r.a.createElement(m.a,{exact:!0,path:"/player/:playerId"},r.a.createElement(Z,null)),r.a.createElement(m.a,{path:"*"},r.a.createElement(j,null))))))):r.a.createElement(F,null,"Loading user")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[317,1,2]]]);
//# sourceMappingURL=main.04823b38.chunk.js.map