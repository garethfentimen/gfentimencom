(this["webpackJsonpafo-frontend"]=this["webpackJsonpafo-frontend"]||[]).push([[0],{237:function(e,t,n){e.exports=n.p+"static/media/bgPattern.abbb91ac.svg"},251:function(e,t,n){e.exports=n(290)},256:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){},284:function(e,t,n){},286:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){},289:function(e,t,n){},290:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),o=n.n(c),i=(n(256),n(17)),s=n.n(i),l=n(26),u=n(23),m=(n(258),function(){return r.a.createElement("div",{className:"loading"},r.a.createElement("div",{className:"loading-text-container"},r.a.createElement("div",null,"loading...")),r.a.createElement("div",{className:"app-logo-container"},r.a.createElement("img",{src:"MainLogo.svg",className:"app-logo-loading",alt:"ball-logo"})))}),p=(n(259),function(e){var t=e.children,n=e.green,a=e.onClick,c=e.primary,o=e.lg,i=e.link,s="button ";return s+=c?"primary-btn":"",s+=e.secondary?"secondary-btn":"",s+=n?"green-btn":"",s+=o?" lg-btn":" md-btn",r.a.createElement("a",{href:i,className:s,onClick:a},t)});p.default={link:""};var d=p,f=(n(317),n(220),n(306),n(219),n(312)),h=n(313),g=n(314),b=n(235),y=n.n(b),v=n(103),E=n(147),j=n(69);function k(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()}var x={"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},O=function e(){Object(j.a)(this,e)};O.getTeamsForLeague=function(e){return new Promise((function(t,n){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},body:JSON.stringify({query:"query { teamsInCompetition(competitionId: ".concat(e,") {")+"teamId\n                    standing\n                    competitionId\n                }}"})}).then((function(e){return e.json()})).then((function(e){console.log(e.data),t(e.data.teamsInCompetition)})).catch((function(e){n(e)}))}))},O.getTeamFromTeamId=function(e){return new Promise((function(t,n){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},body:JSON.stringify({query:"query { getTeam(filter: { teamId: ".concat(e," }) {")+"name \n                     logo\n                     _id\n                     ground {\n                        name\n                        capacity\n                        city\n                      }\n                }}"})}).then((function(e){return e.json()})).then((function(e){console.log(e.data.getTeam);var n=e.data.getTeam;t({name:n.name,_id:n._id,logo:n.logo,ground:n.ground.name,capacity:n.ground.capacity,city:n.ground.city})})).catch((function(e){n(null,e)}))}))};var I=m;var N=n(307),w=n(308),S=n(234),T=n.n(S),C=n(238);n(284);function A(e,t){return F.apply(this,arguments)}function F(){return(F=Object(l.a)(s.a.mark((function e(t,n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},body:JSON.stringify({query:"query { competitions(filter:"+"{ isCurrent: false, tier: ".concat(t,', country: "').concat(n,'" }, sort: START_DATE_DESC) { ')+"name\n                        leagueId\n                }}"})});case 3:return a=e.sent,e.next=6,a.json();case 6:return r=e.sent,e.abrupt("return",r.data.competitions[0]);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}var q=function e(){Object(j.a)(this,e)};function P(e){return B.apply(this,arguments)}function B(){return(B=Object(l.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},body:JSON.stringify({query:"query { broadcastRevenue(filter: { competitionId: ".concat(t," }) {")+"equalShare\n                    basicAward\n                    solidarity\n                    meritStart\n                    centralCommercial\n                    overseasPaymentMin\n                    minimumFeaturedGames\n                    facilityFeePerGame\n                }}"})});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a.data.broadcastRevenue[0]);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function L(e,t){return J.apply(this,arguments)}function J(){return(J=Object(l.a)(s.a.mark((function e(t,n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},body:JSON.stringify({query:"query { attendances(filter: { competitionId: ".concat(n,", teamId: ").concat(t," }) {")+"attendance\n                }}"})});case 3:return a=e.sent,e.next=6,a.json();case 6:return r=e.sent,e.abrupt("return",r.data.attendances[0]);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function z(e){return G.apply(this,arguments)}function G(){return(G=Object(l.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:x,body:JSON.stringify({query:"query { coaches(filter: { currentTeamId: ".concat(t," }) {")+"firstName\n                    lastName\n                    knownAs\n                    career {\n                        teamId,\n                        start,\n                        end\n                    }\n                }}"})});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a.data.coaches[0]);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}q.getCompetitionsForCountry=function(e){return new Promise((function(t,n){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},body:JSON.stringify({query:'query { competitions(filter: { AND: [{ isCurrent: true }, { country: "'.concat(e,'" }, { type: LEAGUE }]})')+"{ name leagueId isCurrent tier logo country }}"})}).then((function(e){return e.json()})).then((function(e){t(e)})).catch((function(e){return n(e)}))}))};var U=r.a.createContext("competition"),M=function(e){var t=e.broadcastingRevenue,n=e.onBack,c=e.teamInfo,o=Object(a.useContext)(U);console.log("comp:",o,c);var i=Object(a.useState)(null),m=Object(u.a)(i,2),p=m[0],d=m[1],f=Object(a.useState)(null),h=Object(u.a)(f,2),g=h[0],b=h[1];Object(a.useEffect)((function(){Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(c.teamId);case 2:return t=e.sent,e.next=5,A(o.tier,o.country);case 5:return n=e.sent,e.next=8,L(c.teamId,n.leagueId);case 8:a=e.sent,d(a),b(t);case 11:case"end":return e.stop()}}),e)})))()}),[o,c.teamId]);var y=[],v=function(e,t){if(e){var n=parseFloat(e);return y.push({angle:n,label:"\xa3".concat(n.toFixed(1),"m"),subLabel:"".concat(t)}),n}return 0},E=(v(t.equalShare,"Equal Share")+v(t.basicAward,"Basic Award")+v(t.solidarity,"Solidarity")+v((t.minimumFeaturedGames+1)*t.facilityFeePerGame,"Featured Game Facility Fees")+v(t.overseasPaymentMin,"Overseas")+v(t.centralCommercial,"Central Commercial")).toFixed(1);return r.a.createElement(r.a.Fragment,null,g?r.a.createElement(N.a,{container:!0,className:"pad-md-left"},r.a.createElement(N.a,{item:!0,xs:"1"},r.a.createElement(w.a,{variant:"contained",color:"secondary",onClick:function(){return n()},startIcon:r.a.createElement(T.a,null)},"Back")),r.a.createElement(N.a,{item:!0,xs:"3"},r.a.createElement("h3",{class:"text-center"},c.name," Financial Analysis"),r.a.createElement("img",{src:c.logo,class:"team-logo pad-left-xxl",alt:"".concat(c.name," logo")}),r.a.createElement("div",{class:"text-center"},c.ground,", ",c.city),r.a.createElement("div",{class:"text-center"},"Capacity: ",c.capacity.toLocaleString("en-GB")),void 0!==g&&r.a.createElement("div",{class:"text-center"},"Current Manager: ",g.knownAs||g.firstName+" "+g.lastName)),r.a.createElement(N.a,{item:!0,xs:"7",className:"pad-left-md"},r.a.createElement("span",null,"Minimum Estimated Broadcasting Revenue: \xa3",E,"m"),y.length>0||"0.0"===y[0].value?r.a.createElement(C.a,{colorType:"linear",colorDomain:[0,2],data:y,width:300,height:250,showLabels:!0,labelsAboveChildren:!0,className:"broadcasting-radial"}):r.a.createElement("div",null,"No information found for broadcasting")),r.a.createElement(N.a,{item:!0,xs:"4"}),p?r.a.createElement(N.a,{item:!0,xs:"8"},r.a.createElement("span",null,"Average attendance last season: ",p.attendance.toLocaleString("en-GB"))):r.a.createElement("loading",null),r.a.createElement(N.a,{item:!0,xs:"4"}),r.a.createElement(N.a,{item:!0,xs:"8"},r.a.createElement("span",null,"Estimated Expenses: \xa3",E,"m")),r.a.createElement(N.a,{item:!0,xs:"4"}),r.a.createElement(N.a,{item:!0,xs:"8"},r.a.createElement("span",null,"Potential Cash Generation: \xa3",E,"m"))):r.a.createElement(r.a.Fragment,null,r.a.createElement(I,null),r.a.createElement("div",null,"Finding team information")))},R=(n(286),n(309)),W=n(311),_=n(310),D=d,Y=function(e){e.competitionId;var t=e.onAnalyseTeam,n=e.teamInfo,a=n.name;return r.a.createElement(R.a,{className:"team-card"},r.a.createElement(_.a,null,r.a.createElement("div",{className:"team-content"},r.a.createElement("img",{src:n.logo,alt:"".concat(a," logo")}))),r.a.createElement(W.a,null,r.a.createElement(D,{onClick:function(){return t(n)},green:!0},"Analyse ",a)))},$=function(){var e=Object(a.useContext)(U).leagueId,t=function(e,t){var n=Object(a.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(a){return console.log(a),t}})),r=Object(u.a)(n,2),c=r[0],o=r[1];return[c,function(t){try{var n=t instanceof Function?t(c):t;o(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(a){console.log(a)}}]}("teamsByCompetitionId",[]),n=Object(u.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)([]),m=Object(u.a)(i,2),p=m[0],d=m[1],f=Object(a.useState)(null),h=Object(u.a)(f,2),g=h[0],b=h[1],y=Object(a.useState)(null),j=Object(u.a)(y,2),k=j[0],x=j[1];return Object(a.useEffect)((function(){Object(l.a)(s.a.mark((function t(){var n,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=c[e])){t.next=5;break}d(n),t.next=9;break;case 5:return t.next=7,O.getTeamsForLeague(e);case 7:a=t.sent,Promise.all(a.map(function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getTeamFromTeamId(t.teamId);case 2:return(n=e.sent).teamId=t.teamId,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(t){d(t),o(Object(E.a)(Object(E.a)({},c),{},Object(v.a)({},e,t)))}));case 9:case"end":return t.stop()}}),t)})))()}),[]),Object(a.useEffect)((function(){Object(l.a)(s.a.mark((function t(){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!g){t.next=5;break}return t.next=3,P(e);case 3:n=t.sent,x(n);case 5:case"end":return t.stop()}}),t)})))()}),[g]),p.length>0?g&&k?r.a.createElement(M,{onBack:function(){return b(null)},broadcastingRevenue:k,teamInfo:g}):r.a.createElement("div",{className:"team-cards"},p.map((function(e){return r.a.createElement(Y,{onAnalyseTeam:function(e){return b(e)},key:e.teamId,teamInfo:e})}))):r.a.createElement(I,null)},H=(n(287),r.a.createContext("user")),K=function(e){var t=e.competitions,n=Object(a.useState)("men"),c=Object(u.a)(n,2),o=c[0],i=(c[1],Object(a.useState)(null)),s=Object(u.a)(i,2),l=s[0],m=s[1],p=Object(a.useContext)(H);return console.info(p),r.a.createElement("section",{className:"leagues"},r.a.createElement("div",{className:"pad-all-sm marg-bottom-sm flex",style:{color:"#fff",fontSize:"1.2rem"}},r.a.createElement("span",{className:"text-center",style:{width:"90%"}},"Take control! Select a team to analyse for financial viability."),r.a.createElement("span",{className:"align-right"},"Budget: 7m")),"men"===o?t.filter((function(e){return!e.name.includes("WSL")&&(null===l||l===e.leagueId)})).sort((function(e,t){return e.tier>t.tier?1:-1})).map((function(e){return r.a.createElement(f.a,{key:e.leagueId,onChange:function(t,n){console.log(n),m(n?e.leagueId:null)},className:"team-select-acc",TransitionProps:{unmountOnExit:!0}},r.a.createElement(h.a,{expandIcon:r.a.createElement(y.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},e.name),r.a.createElement(g.a,null,r.a.createElement(U.Provider,{value:e},r.a.createElement($,null))))})):t.filter((function(e){return e.name.includes("WSL")})).sort((function(e,t){return e.tier>t.tier?1:-1})).map((function(e){return r.a.createElement("div",{key:e.leagueId,className:"league"},r.a.createElement("div",{className:"league-name"},e.name),r.a.createElement("div",{className:"league-logo"},r.a.createElement(U.Provider,{value:e},r.a.createElement($,null))))})))},Q=function e(){Object(j.a)(this,e)};Q.getUsersFromId=function(e){return new Promise((function(t,n){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},body:JSON.stringify({query:"query getUsers {\n                    users(filter: { twitterId: ".concat(e," }) {\n                      screenName\n                      name\n                      location\n                      authLevel\n                      userId\n                    }\n                  }")})}).then((function(e){return e.json()})).then((function(e){t(e.data.users)})).catch((function(e){n(e)}))}))},Q.getUserInfo=function(){return new Promise((function(e,t){return fetch("https://afcmbackend.herokuapp.com/graphql".replace("graphql","api/user"),{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+k("token")}}).then((function(e){return e.json()})).then((function(t){console.log(t.user),e(t.user)})).catch((function(e){t(e)}))}))},Q.createUser=function(e){var t=e.name,n=e.screenName,a=e.location,r=e.userId;return new Promise((function(e,c){return fetch("https://afcmbackend.herokuapp.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+k("token")},body:JSON.stringify({query:"mutation addUser { \n                    createUser(record:{ twitterId: ".concat(r,', screenName: "').concat(n,'", name: "').concat(t,'", location: "').concat(a,'", authLevel: PLAYER}) {\n                    recordId,\n                    record {\n                      name\n                      userId\n                      screenName\n                      location\n                      authLevel\n                    },\n                    error {\n                      message\n                    }\n                  }\n                }')})}).then((function(e){return e.json()})).then((function(t){console.log(t.data),e(t.data)})).catch((function(e){c(e)}))}))};n(288);var V=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)([]),i=Object(u.a)(o,2),p=i[0],f=i[1],h=Object(a.useState)(null),g=Object(u.a)(h,2),b=g[0],y=g[1],v=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,Q.getUserInfo();case 3:if(!(t=e.sent)){e.next=16;break}return e.next=7,Q.getUsersFromId(parseInt(t.userId));case 7:if(0!==(n=e.sent).length){e.next=15;break}return e.next=11,Q.createUser(t);case 11:(a=e.sent).error.message?console.error("unable to create user: ",a.error.message):y(a.record),e.next=16;break;case 15:y(n[0]);case 16:return e.next=18,q.getCompetitionsForCountry("England");case 18:(r=e.sent)&&r.data?(f(r.data.competitions),c(!1)):console.error("unable to retrieve competitions",r);case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"app-start"},!n&&0===p.length&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"heading"},r.a.createElement("div",{className:"text-logo-left"},r.a.createElement("img",{src:"LogoFFOText.svg",className:"text-logo",alt:"logo"})),r.a.createElement("div",{className:"text"},"Welcome to Fantasy Football Owner ",document.cookie.userName),r.a.createElement("div",{className:"text-logo-right"},r.a.createElement("img",{src:"LogoFFOText.svg",className:"text-logo",alt:"logo"}))),r.a.createElement("section",{className:"app-start-action"},r.a.createElement("span",null,"This is a Fantasy Football game based on real events/data"),r.a.createElement("span",null,"Manager transitions, player crises, financial ruin?! This is fantasy football like no other."),r.a.createElement("span",null,"Legal notice: this is a non-comercial/amateur game. Players/users do not pay for any service."),r.a.createElement(d,{green:!0,lg:!0,onClick:v},"Start new game"))),n&&r.a.createElement(m,null),!n&&p.length>0&&r.a.createElement(H.Provider,{value:b},r.a.createElement(K,{competitions:p})))},X=n(315),Z=(0,n(232).createMuiTheme)({palette:{primary:{main:"#69bb31"},secondary:{main:"#8f214d"}}}),ee=n(237),te=n.n(ee);n(289);var ne=function(){return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"background"},r.a.createElement("img",{alt:"background pattern",src:te.a})),r.a.createElement(X.a,{theme:Z},r.a.createElement(V,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ne,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[251,1,2]]]);
//# sourceMappingURL=main.ca58fef8.chunk.js.map